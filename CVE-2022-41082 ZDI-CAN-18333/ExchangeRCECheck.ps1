<# Scripts are not supported 
-- Script to check for ZDI-CAN-18333 and ZDI-CAN-18802 configuration for your autodiscover service to block known attack patterns. #>
Write-Host "Refer to README Looking for Open HTTPS AutoDiscover "
$Server = Read-Host -Prompt 'Input your AutoDiscover Hostname'
Write-Host "Checking AutoDiscover Host '$Server'"
$port = 5896
$connection = New-Object System.Net.Sockets.TcpClient($Server, $port)
if ($connection.Connected) {
	Write-Host "URL Rewrite to AutoDiscover Service is allowed check to make sure the Exchange Servers are patched and any shells have not been uploaded"
} else {
	Write-Host "Good the URL Rewrite to AutoDiscover Service is NOT allowed"
}

